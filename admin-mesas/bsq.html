<!DOCTYPE html>
<html lang="en" class="loading">

<head>

	<script>
		window.dataLayer = window.dataLayer || [];
		var nombrecodigo = {percodnotif};
		dataLayer.push({'event' : 'login', 'userId' : nombrecodigo});
		</script>
	<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
		new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
		j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
		'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
		})(window,document,'script','dataLayer','GTM-MW2RMSR');</script>

	<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
	<meta http-equiv="X-UA-Compatible" content="IE=edge">
	<meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimal-ui">
	<meta name="description"
    content="BTBOX _your business toolbox. Todas las soluciones en una plataforma para potenciar tu prÃ³ximo evento">
    <meta name="keywords"
    content="btbox, evento, fisico, hibrido, event, admin, btoolbox, networking, reuniones">
    <meta name="author" content="BTBOX">
	<title>{SisNombreEvento}</title>
    <link rel="shortcut icon" type="image/png" href="../assets-nuevodisenio/img/logo.jpg">
	<meta name="apple-mobile-web-app-capable" content="yes">
	<meta name="apple-touch-fullscreen" content="yes">
	<meta name="apple-mobile-web-app-status-bar-style" content="default">
	<link rel="stylesheet" type="text/css" href="../assets-nuevodisenio/vendors/css/tables/datatable/datatables.min.css">
	<link rel="stylesheet" type="text/css" href="../assets-nuevodisenio/index.css">
	<link href="../assets-nuevodisenio/css/select2.css" rel="stylesheet" />
<!-- script para levantar el navbar -->
<script src="https://code.jquery.com/jquery-1.10.2.js"></script>
<!-- ---------------------------------- X ---------------------------------- -->
</head>

<body data-col="2-columns" class=" 2-columns " >

<div class="wrapper nav-collapsed menu-collapsed">
	<!-- Navigation bar -->
	<div id="nav-placeholder">

	</div>

	<script>
		$(function () {
			var data = {
				"menu": "activeindex"
			};

			$("#nav-placeholder").load("../navbar/navbar.php", data);

		});
	</script>
	<!-- end of Navigation bar -->

<!--MENU FIN-->

		<div class="main-panel">
			<div class="main-content">
				<div class="content-wrapper">
					<div class="container-fluid">

						<!--Inicio TABLA -->
						<section id="shopping-cart">
							<div class="row">
								<div class="col-sm-12">
									<div class="">
										<div class="mb-2">
											<div class="bar-success ">
												<h4 class="">{backcalendariomesas}</h4>
												<h6 class="">{backcalendariomesassubtitulo}</h6>
											</div>
										</div>
										<div class="mt-3">
											<div class="row pb-3">
												
												<div class="col-md-2">
													<label for="fecha">Fecha:</label>
													<input  type="date" data-date-inline-picker="true" id="fecha" class="form-control" value="{fechaincioreunion}"  min="{fechainicial}" max="{fechafinal}" name="agefch" placeholder="Seleccione la fecha...">
												</div>
												<div class="col-md-3 mb-2">
													<label for="desde">Tipos de mesa:</label>
													<select id="tipo"  name="tipo" class="form-control" style="width:100%" onchange="loadTables(this);" >
														<option value="0">Seleccion tipo de mesa</option>
														<option value="999999">{Idioma_Buscartodos}</option>
														<option value="1">{mesatipo1}</option>
														<option value="2">{mesatipo2}</option>
													
														
													  </select>
												</div>
												<div id="displaycmbmesas" class="col-md-5 mb-2">
													<label for="desde">Mesas:</label>
													<select id="cmbmesas"  name="cmbmesas" class="form-control" style="width:100%" multiple="multiple">
										
													  </select>
													  <div id="displaycheckboxmesas">
														<input type="checkbox" id="checkboxmesas"> {Idioma_Buscartodos}
													  </div>
												</div>
												<div class="col-md-1" style="text-align: center; margin-top: 1.5rem;">
													<button id="btnfiltrar" type="button" class="btn btn-success " onclick="filtrar();">
														<i id="spinnercoordinar" class="fa fa-spinner fa-spin"> </i> {backcalendarioreunionesfiltrar}
													</button>
												</div>
												<div class="col-md-1" style="text-align: center; margin-top: 1.5rem;">
		
													<button id="btnlimpiarfiltrar" type="button" class="btn btn-info " onclick="limpiarfiltrar();">
														Limpiar Filtro
													</button>
												</div>
												
												</div>
										</div>
									</div>
								</div>
							</div>
							<div class="card-block" id="DataBrowser"></div>
							<div class="card-block" id="DataMaestro"></div>
						</section>

						<!--Fin TABLA -->

					</div>
				</div>
			</div>
		</div>
	</div> <!-- FIN- <div class="wrapper"> -->

	<!-- Modal -->
	<div class="modal fade p-0 text-left" id="DataMaestroDisp" tabindex="-1" role="dialog" aria-hidden="true">
		<div class="modal-dialog modal-lg" role="document" id="DataDisp">
		</div>
	</div>
	<div class="modal fade p-0 text-left" id="DataMaestroViewPerfil" tabindex="-1" role="dialog" aria-hidden="true"
		data-backdrop="static" data-keyboard="false">
		<div class="modal-dialog modal-lg" role="document" id="DataViewPerfil">
		</div>
	</div>
	<div class="modal fade p-0 text-left" id="DataMaestroViewHorario" tabindex="-1" role="dialog" aria-hidden="true"
	data-backdrop="static" data-keyboard="false">
		<div class="modal-dialog modal-lg" role="document" id="DataViewHorario" style="max-width:80%;">
		</div>
	</div>
	<div class="modal fade p-0 text-left" id="DataMaestroView" tabindex="-1" role="dialog" aria-hidden="true"
	data-backdrop="static" data-keyboard="false">
		<div class="modal-dialog modal-lg" role="document" id="DataView" style="max-width:80%;">
		</div>
	</div>


	<!-- Inicio CONFIGURACION -->
	<aside id="notification-sidebar" class="notification-sidebar d-none d-sm-none d-md-block">
		<a class="notification-sidebar-close">
			<i class="ft-x font-medium-3"></i>
		</a>
		<div class="side-nav notification-sidebar-content">
			<div class="row">
				<div class="col-12 mt-1">

					<div id="activity-timeline" class="col-12 timeline-left">
						<h6 class="mt-1 mb-3 text-bold-400">{filtros}</h6>


						<div class="timeline">
							<ul class="list-unstyled base-timeline activity-timeline ml-0">

								<li>
									<div class="timeline-icon bg-primary">
										<i class="fa fa-plane"></i>
									</div>
									<div class="base-timeline-info">
										<a href="#" class="text-uppercase text-primary">{Idioma_Descripcion}</a>
										<br>
										<div class="form-group row">
											<div class="col-md-12">
												<input type="text" id="fltdescri" name="fltdescri" class="form-control"
													value="" placeholder="">
											</div>
										</div>
								</li>

							</ul>

							<div class="card-body">
								<div class="card-block">
									<form>
										<div class="form-group">
											<div class="text-center mt-4">
												<button type="button"
													class="btn btn-primary px-4 py-2 text-uppercase white font-small-4 box-shadow-2 border-0"
													onclick="showBrowser();">{buscar}</button>
											</div>
										</div>
									</form>
								</div>
							</div>
						</div>
					</div>


				</div>
			</div>
		</div>
	</aside>
	<!-- Fin CONFIGURACION -->

	<!-- BEGIN VENDOR JS-->
	<script src="../assets-nuevodisenio/vendors/js/core/jquery-3.3.1.min.js"></script>
	<script src="../assets-nuevodisenio/vendors/js/core/popper.min.js"></script>
	<script src="../assets-nuevodisenio/vendors/js/core/bootstrap.min.js"></script>
	<script src="../assets-nuevodisenio/vendors/js/perfect-scrollbar.jquery.min.js"></script>
	<script src="../assets-nuevodisenio/vendors/js/prism.min.js"></script>
	<script src="../assets-nuevodisenio/vendors/js/jquery.matchHeight-min.js"></script>
	<script src="../assets-nuevodisenio/vendors/js/screenfull.min.js"></script>
	<script src="../assets-nuevodisenio/vendors/js/pace/pace.min.js"></script>
	<!-- BEGIN VENDOR JS-->
	<!-- BEGIN PAGE VENDOR JS-->
	<!-- END PAGE VENDOR JS-->
	<!-- BEGIN CONVEX JS-->
	<script src="../assets-nuevodisenio/vendors/js/datatable/datatables.min.js"></script>
    <script src="../assets-nuevodisenio/vendors/js/datatable/dataTables.buttons.min.js"></script>
    <script src="../assets-nuevodisenio/vendors/js/datatable/buttons.flash.min.js"></script>
    <script src="../assets-nuevodisenio/vendors/js/datatable/jszip.min.js"></script>
    <script src="../assets-nuevodisenio/vendors/js/datatable/pdfmake.min.js"></script>
    <script src="../assets-nuevodisenio/vendors/js/datatable/vfs_fonts.js"></script>
    <script src="../assets-nuevodisenio/vendors/js/datatable/buttons.html5.min.js"></script>
    <script src="../assets-nuevodisenio/vendors/js/datatable/buttons.print.min.js"></script>
	<script src="../assets-nuevodisenio/js/app-sidebar.js"></script>
	<script src="../assets-nuevodisenio/js/notification-sidebar.js"></script>
	<!-- END CONVEX JS-->
	<!-- BEGIN PAGE LEVEL JS-->
	<!-- END PAGE LEVEL JS-->

	<!-- BEGIN VENDOR JS-->
	<!-- BEGIN PAGE VENDOR JS-->
	<script src="../assets-nuevodisenio/js/data-tables/datatable-advanced.js"></script>
	<script src="../assets-nuevodisenio/vendors/js/sweetalert2.min.js"></script>
	<script src="../assets-nuevodisenio/vendors/js/toastr.min.js"></script>
	<script src="../assets-nuevodisenio/vendors/js/switchery.min.js"></script>
	<script src="../assets-nuevodisenio/js/select2.js"></script>

	<!-- END PAGE VENDOR JS-->
	<script>
		var dataDisponibilidad = [];
		document.querySelector("#spinnercoordinar").style.display = 'none';
		document.querySelector("#displaycheckboxmesas").style.display = 'none';
		
		$(document).ready(function () {
			$('#cmbmesas').select2({
				placeholder: "{seleccionaopcion}"
				
			});
			document.querySelector("#displaycmbmesas").style.visibility = "hidden";
			//showBrowser(0);

			//$('#fltbuscar').keypress(function (event){if (event.which == 13) { showBrowser(); } });	
		});
		$("#checkboxmesas").click(function(){
			if($("#checkboxmesas").is(':checked') ){
				$("#cmbmesas > option").prop("selected","selected");// Select All Options
				$("#cmbmesas").trigger("change");// Trigger change to select 2
			}else{
				$('#cmbmesas').val(null).trigger('change');
			}
		});
		function limpiarfiltrar(){
			document.querySelector("#fecha").value='{fechaincioreunion}';
			document.querySelector("#tipo").value=0;
			document.querySelector("#displaycmbmesas").style.visibility = "hidden";
			$('#cmbmesas').val(null).trigger('change');
			

		}
		function filtrar() {
			document.querySelector("#spinnercoordinar").style.display = '';
			var errcod =0;
			
		var fecha = $("#fecha").val();
		var tipo = $("#tipo").val();
		var cmbmesas = $('#cmbmesas').val();
		var mesas = [0];
		$.each(cmbmesas, function (i, val) {
			if (val!=''){
				mesas.push(val); 
			}
			
			
		});
			if (fecha == ''){
				errcod=2;
				toastr.error("Debe elegir una fecha", "ERROR!");
				document.querySelector("#spinnercoordinar").style.display = 'none';
			}
			
			if (mesas == 0){
				errcod=2;
				toastr.error("Debe elegir al menos un participante", "ERROR!");
				document.querySelector("#spinnercoordinar").style.display = 'none';
			}
			if (tipo == 0){
				errcod=2;
				toastr.error("Debe elegir un tipo de mesa", "ERROR!");
				document.querySelector("#spinnercoordinar").style.display = 'none';
			}
			if (errcod == 0){
				var data = { "fecha": fecha,
						 "mesas":mesas };
						
				$('#DataBrowser').load('brw.php', data);
				$('#DataMaestro').css('display', 'none');
				$('#DataBrowser').css('display', '');
			}
		}
		function coordinarReunion(sol,fecha,hora) {
			
			var data = { "mesasolicitante": sol,
						 "fechasolicitante": fecha,
						 "horasolicitante": hora };

			$('#DataView').load('mst.php', data);
			$('#DataMaestroView').modal('show');
			$('#DataMaestroViewHorario').modal('hide');

		}
		function solicitarReunionMaestro(solicitante,contraparte, tipo,fechasolicitante,horasolicitante,reuconfnoti,mesasolicitante) {
				
				var data = { "solicitante": solicitante,
							 "contraparte": contraparte, 
							 "tipo": tipo,
							 "fechasolicitante": fechasolicitante,
							 "horasolicitante": horasolicitante,
							 "reuconfnoti": reuconfnoti,
							"mesasolicitante": mesasolicitante};

		
			
			$.ajax({
				type: "POST",
				url: '../admin-mesas/coordinargrb.php',
				data: data
			}).done(function (rsp) {
				data = $.parseJSON(rsp);

				if (data.errcod == 0) {
					toastr.success(data.errmsg, 'MEETING');
					$('#DataMaestroView').modal('hide');
					filtrar();
				} else {
					toastr.error(data.errmsg, 'MEETING');
					//swal("GUARDAR", data.errmsg, "error").done();
				}
				
			});
				
			
		}
		function aceptarReunion(reureg,solicitante,contraparte,reufecha,reuhora,mesasolicitante) {
				var data = { "solicitante": solicitante,
							 "contraparte": contraparte,
							 "reureg": reureg,
							 "fechasolicitante":reufecha,
							 "horasolicitante":reuhora,
							"mesasolicitante": mesasolicitante};

				swal({
					title: "{Idioma_GuardarSwal}",
					text: "{Idioma_ConfirmarReunionPendiente}",
					type: 'warning',
					showCancelButton: true,
					confirmButtonColor: '#0CC27E',
					cancelButtonColor: '#FF586B',
					confirmButtonText: '{Idioma_BotonConf}',
					cancelButtonText: '{Idioma_BotonCan}',
					confirmButtonClass: 'btn btn-success btn-raised mr-5',
					cancelButtonClass: 'btn btn-danger btn-raised',
					buttonsStyling: false
				}).then(function () {
					$.ajax({
						type: "POST",
						url: 'coordinargrbsoli.php',
						data: data
					}).done(function (rsp) {
						data = $.parseJSON(rsp);
						if (data.errcod == 0) {
							toastr.success(data.errmsg, 'MEETING');
						} else {
							toastr.error(data.errmsg, 'MEETING');
						}
						filtrar();
					});

				}, function (dismiss) {
				// dismiss can be 'overlay', 'cancel', 'close', 'esc', 'timer'
				if (dismiss === 'cancel') {
				}
			}).done();
		}
		function eliminarReunion(reg){
		var reureg = reg
		
		var data = {"reureg":reureg};
		
		swal({
			title: "{Idioma_Eliminar}",
			text: "{Idioma_ConfEliminarSec}",
			type: 'warning',
			showCancelButton: true,
			confirmButtonColor: '#0CC27E',
			cancelButtonColor: '#FF586B',
			confirmButtonText: '{Idioma_BotonConf}',
			cancelButtonText: '{Idioma_BotonCan}',
			confirmButtonClass: 'btn btn-success btn-raised mr-5',
			cancelButtonClass: 'btn btn-danger btn-raised',
			buttonsStyling: false
		}).then(function () {
			$.ajax({
			  type: "POST",
			  url: 'del.php',
			  data: data
			}).done(function( rsp ) {
				
				data = $.parseJSON(rsp);
				
				if(data.errcod == 0){			
					toastr.success(data.errmsg, '{Idioma_Eliminar}');
					//swal("GUARDAR", data.errmsg, "success").done();
					filtrar();
				}else{
					toastr.error(data.errmsg, '{Idioma_Eliminar}');
					//swal("GUARDAR", data.errmsg, "error").done();
				}
				
			});
			
			
		}, function (dismiss) {
			// dismiss can be 'overlay', 'cancel', 'close', 'esc', 'timer'
			if (dismiss === 'cancel') {
			}
		}).done();
	}
	function eliminarreunionsoli(reg){
		var reureg = reg
		
		var data = {"reureg":reureg};
		
		swal({
			title: "{Idioma_Eliminar}",
			text: "{Idioma_ConfEliminarSec}",
			type: 'warning',
			showCancelButton: true,
			confirmButtonColor: '#0CC27E',
			cancelButtonColor: '#FF586B',
			confirmButtonText: '{Idioma_BotonConf}',
			cancelButtonText: '{Idioma_BotonCan}',
			confirmButtonClass: 'btn btn-success btn-raised mr-5',
			cancelButtonClass: 'btn btn-danger btn-raised',
			buttonsStyling: false
		}).then(function () {
			$.ajax({
			  type: "POST",
			  url: 'delsoli.php',
			  data: data
			}).done(function( rsp ) {
				
				data = $.parseJSON(rsp);
				
				if(data.errcod == 0){			
					toastr.success(data.errmsg, '{Idioma_Eliminar}');
					//swal("GUARDAR", data.errmsg, "success").done();
					filtrar();
				}else{
					toastr.error(data.errmsg, '{Idioma_Eliminar}');
					//swal("GUARDAR", data.errmsg, "error").done();
				}
				
			});
			
			
		}, function (dismiss) {
			// dismiss can be 'overlay', 'cancel', 'close', 'esc', 'timer'
			if (dismiss === 'cancel') {
			}
		}).done();
	}
		function loadTables(obj) {//Se cargan las clases en relacion con el Tipo de Perfil
		var tipo = $(obj).val();
		if (tipo == 0){
			document.querySelector("#displaycmbmesas").style.visibility = "hidden";
			document.querySelector("#displaycheckboxmesas").style.display = 'none';
		}else{
			if (tipo == 999999){
				document.querySelector("#displaycheckboxmesas").style.display = 'none';
			}else{
				document.querySelector("#displaycheckboxmesas").style.display = '';
				document.querySelector("#checkboxmesas").checked = false;;
			}
			document.querySelector("#displaycmbmesas").style.visibility = "";
		}
		
        
		$.ajax({
			type: "POST",
			url: "gettables.php",
			data: { "tipo": tipo }
		}).done(function (rsp) {

			data = $.parseJSON(rsp);
			
			var cmbmesas = $('#cmbmesas');
			cmbmesas.empty();
			$("<option/>", {
				val: '',
				text: '{Idioma_Seleccione}...'
			}).appendTo(cmbmesas);

			$.each(data, function () {
				//console.log(this.perclase);
				//console.log(this.perclades);
				$("<option/>", {
					val: this.mescodigo,
					text: this.mesnumero
				}).appendTo(cmbmesas);
			});
		});

	}
		

	</script>


</body>

</html>