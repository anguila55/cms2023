<!DOCTYPE html>
<html lang="en" class="loading">
  <head>

	<script>
		window.dataLayer = window.dataLayer || [];
		var nombrecodigo = {percodnotif};
		dataLayer.push({'event' : 'login', 'userId' : nombrecodigo});
		</script>
	<script>(function(w,d,s,l,i){w[l]=w[l]||[];w[l].push({'gtm.start':
		new Date().getTime(),event:'gtm.js'});var f=d.getElementsByTagName(s)[0],
		j=d.createElement(s),dl=l!='dataLayer'?'&l='+l:'';j.async=true;j.src=
		'https://www.googletagmanager.com/gtm.js?id='+i+dl;f.parentNode.insertBefore(j,f);
		})(window,document,'script','dataLayer','GTM-MW2RMSR');</script>

    <meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0, user-scalable=0, minimal-ui">
	<meta name="description"
    content="BTBOX _your business toolbox. Todas las soluciones en una plataforma para potenciar tu prÃ³ximo evento">
    <meta name="keywords"
    content="btbox, evento, fisico, hibrido, event, admin, btoolbox, networking, reuniones">
    <meta name="author" content="BTBOX">
	<title>{SisNombreEvento}</title>
    <link rel="shortcut icon" type="image/png" href="../assets-nuevodisenio/img/logo.jpg">
    <meta name="apple-mobile-web-app-capable" content="yes">
    <meta name="apple-touch-fullscreen" content="yes">
    <meta name="apple-mobile-web-app-status-bar-style" content="default">
	<link rel="stylesheet" type="text/css" href="../assets-nuevodisenio/vendors/css/tables/datatable/datatables.min.css">
	<link rel="stylesheet" type="text/css" href="../assets-nuevodisenio/index.css">
<!-- script para levantar el navbar -->
<script src="https://code.jquery.com/jquery-1.10.2.js"></script>
<!-- ---------------------------------- X ---------------------------------- -->
</head>

<body data-col="2-columns" class=" 2-columns " >

<div class="wrapper nav-collapsed menu-collapsed">
	<!-- Navigation bar -->
	<div id="nav-placeholder">

	</div>

	<script>
		$(function () {
			var data = {
				"menu": "activeindex"
			};

			$("#nav-placeholder").load("../navbar/navbar.php", data);

		});
	</script>
	<!-- end of Navigation bar -->

<!--MENU FIN-->

      <div class="main-panel">
        <div class="main-content">
          <div class="content-wrapper">
            <div class="container-fluid">

				<!--Inicio TABLA -->
				<section id="shopping-cart">
					<div class="row">
						<div class="col-sm-12">
							<div class="card">
								<div class="card-header">
									<div class="card-title-wrap bar-warning">
										<h4 class="card-title">
											{admregistro}
											<a class="success p-0" style="position:absolute;right:20px;" title="Nuevo Registro" onclick="showMaestro(0);">
												<i class="fa ft-plus-circle font-medium-5 mr-2"></i>
											</a>
										</h4>
									</div>
								</div>
								<div class="col-sm-12 col-md-12 {registrounicovisible}">
									<p>Seleccione la clase de perfil para configurar registro</p> 
									<select id="perclase" name="perclase" class="form-control" 
												placeholder="{textoperclase}" onchange="cambiousuarioregistro();">
												<option value="0" selected>Registro generico</option>
												<!-- BEGIN perclases -->
												<option value="{perclacod}" {perclasel}>{perclades}</option>
												<!-- END perclases -->
									</select>
								</div>
								
								<div class="card-body">
									<div class="card-block" id="DataBrowser"></div>
									<div class="card-block" id="DataMaestro"></div>
								</div>
							</div>
						</div>
					</div>
				</section>
				<!--Fin TABLA -->

            </div>
          </div>
        </div>
      </div>
    </div> <!-- FIN- <div class="wrapper"> -->

	<!-- Modal -->
	<div class="modal fade p-0 text-left" id="DataMaestroDisp" tabindex="-1" role="dialog" aria-hidden="true">
		<div class="modal-dialog modal-lg" role="document" id="DataDisp">
		</div>
	</div>



    <!-- BEGIN VENDOR JS-->
    <script src="../assets-nuevodisenio/vendors/js/core/jquery-3.3.1.min.js"></script>
    <script src="../assets-nuevodisenio/vendors/js/core/popper.min.js"></script>
    <script src="../assets-nuevodisenio/vendors/js/core/bootstrap.min.js"></script>
    <script src="../assets-nuevodisenio/vendors/js/perfect-scrollbar.jquery.min.js"></script>
    <script src="../assets-nuevodisenio/vendors/js/prism.min.js"></script>
    <script src="../assets-nuevodisenio/vendors/js/jquery.matchHeight-min.js"></script>
    <script src="../assets-nuevodisenio/vendors/js/screenfull.min.js"></script>
    <script src="../assets-nuevodisenio/vendors/js/pace/pace.min.js"></script>
    <!-- BEGIN VENDOR JS-->
    <!-- BEGIN PAGE VENDOR JS-->
    <!-- END PAGE VENDOR JS-->
    <!-- BEGIN CONVEX JS-->
	<script src="../assets-nuevodisenio/vendors/js/datatable/datatables.min.js"></script>
	<script src="../assets-nuevodisenio/vendors/js/datatable/dataTables.buttons.min.js"></script>
	<script src="../assets-nuevodisenio/vendors/js/datatable/buttons.flash.min.js"></script>
	<script src="../assets-nuevodisenio/vendors/js/datatable/jszip.min.js"></script>
	<script src="../assets-nuevodisenio/vendors/js/datatable/pdfmake.min.js"></script>
	<script src="../assets-nuevodisenio/vendors/js/datatable/vfs_fonts.js"></script>
	<script src="../assets-nuevodisenio/vendors/js/datatable/buttons.html5.min.js"></script>
	<script src="../assets-nuevodisenio/vendors/js/datatable/buttons.print.min.js"></script>
    <script src="../assets-nuevodisenio/js/app-sidebar.js"></script>
    <!-- <script src="../assets-nuevodisenio/js/notification-sidebar.js"></script> -->
    <!-- END CONVEX JS-->
    <!-- BEGIN PAGE LEVEL JS-->
	<script src="https://cdn.quilljs.com/1.3.6/quill.js"></script>
    <!-- END PAGE LEVEL JS-->

	<!-- BEGIN VENDOR JS-->
	<!-- BEGIN PAGE VENDOR JS-->
	<script src="../assets-nuevodisenio/js/data-tables/datatable-advanced.js"></script>
    <script src="../assets-nuevodisenio/vendors/js/sweetalert2.min.js"></script>
	<script src="../assets-nuevodisenio/vendors/js/toastr.min.js"></script>
	<script src="../assets-nuevodisenio/vendors/js/switchery.min.js"></script>
	<script src="../assets-nuevodisenio/js/jquery.multiselect.js"></script>

    <!-- END PAGE VENDOR JS-->
	<script>
		var dataDisponibilidad = [];

		$(document).ready(function() {
			
			showBrowser();

		});

		function cambiousuarioregistro(){
		
			showBrowser();
		}

	

		function crearregistrousuario(){
			

			var formData = new FormData($('#FrmMst')[0]);

			formData.append("usuarioregistro", '');
		
			$.ajax({
				type: "POST",
				url: 'grbregistros.php',
				data: formData,
				cache: false,
				contentType: false,
				processData: false
			}).done(function (rsp) {
				data = $.parseJSON(rsp);
				if (data.errcod == 0) {
					
				} else {
					
				}

				showBrowser();


			});
		}

		function showBrowser(){

			var usuarioregistro = $('#perclase').val();
			var data = {"usuario":usuarioregistro};
		
			$('#DataBrowser').load('brw.php',data);
			$('#DataMaestro').css('display','none');
			$('#DataBrowser').css('display','');


		}
		

		function guardarMaestroBrowser() {

const elegido = Array.from(document.querySelectorAll('#elegido input'));

const requerido = Array.from(document.querySelectorAll('#requerido input'));

variableselegidas = elegido.map(item => { return { nombre: item.name, elegido: item.checked.toString() } });

variablesrequeridas = requerido.map(item => {return {nombre: item.name,requerida: item.checked.toString() }});

var formData = new FormData($('#FrmMst')[0]);


auxdataNombreEsp = [];
auxdataNombreIng = [];
auxdataNombrePor = [];
	
	$.each($('input[name="vardescri"]'), function () {
		var perm = $(this).data('perm');
		var value = $(this).val();
		//console.log(value);
		var data ='';
		
			data = { "perm": perm, "tipori": value};
		auxdataNombreEsp.push(data);
		
	});
	//console.log(auxdataVisibilidad);
	var dataNombreEsp = JSON.stringify(auxdataNombreEsp);


	$.each($('input[name="vardescriing"]'), function () {
		var perm = $(this).data('perm');
		var value = $(this).val();
		var data ='';
		
			data = { "perm": perm, "tipori": value};
		auxdataNombreIng.push(data);
		
	});
	//console.log(auxdataVisibilidad);
	var dataNombreIng = JSON.stringify(auxdataNombreIng);


	$.each($('input[name="vardescripor"]'), function () {
		var perm = $(this).data('perm');
		var value = $(this).val();
		var data ='';
		
			data = { "perm": perm, "tipori": value};
		
		auxdataNombrePor.push(data);
		
	});
	//console.log(auxdataVisibilidad);
	var dataNombrePor = JSON.stringify(auxdataNombrePor);

	var usuarioregistro = $('#perclase').val();

formData.append("variableselegidas", JSON.stringify(variableselegidas));
formData.append("variablesrequeridas", JSON.stringify(variablesrequeridas));
formData.append("dataNombreEsp", dataNombreEsp);
formData.append("dataNombreIng", dataNombreIng);
formData.append("dataNombrePor", dataNombrePor);
formData.append("usuarioregistro", usuarioregistro);


$.ajax({
	type: "POST",
	url: 'grb.php',
	data: formData,
	cache: false,
	contentType: false,
	processData: false
}).done(function (rsp) {
	data = $.parseJSON(rsp);
	if (data.errcod == 0) {
		toastr.success(data.errmsg, '{Idioma_Guardar}');
	} else {
		toastr.error(data.errmsg, '{Idioma_Guardar}');
	}

	showBrowser();

});


}

		function showMaestro(reg) {
			var data = { "varreg": reg };

			$('#DataMaestro').load('mst.php', data);
			$('#DataMaestro').css('display', '');
			$('#DataBrowser').css('display', 'none');
		}


	</script>

  </body>
</html>